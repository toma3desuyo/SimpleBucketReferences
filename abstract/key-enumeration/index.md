---
title: キーの一覧取得
description: 連想配列のキーを一覧取得する方法と注意点
---

## 概要
キー列挙は連想配列やマップから全てのキーを取り出し、順序に沿って処理したり、存在チェックを一括で行うための操作である。

## 性質
- **順序**: 追加順、ソート順、ハッシュ順など実装によって異なる。仕様で保証するかどうかを明示する。
- **スナップショット**: 列挙中にコレクションが変更される場合、スナップショットを返すかリアルタイムで反映するかを決める。
- **フィルタリング**: 非公開キーや継承されたキーを含めるか除外するかのルールを定義する。

## 基本例
```pseudo
設定 = { "host"→"db", "port"→5432 }
for キー in 設定.キー列挙(順序: 追加順):
    表示(キー)
```
- API に順序オプションを持たせると利用者が仕様に依存しなくて済む。

## 応用パターン
### 条件付き列挙
```pseudo
for キー in 設定.キー列挙():
    もし キー が "secret" で始まる なら continue
    処理(キー)
```
- 列挙中にフィルタリングするか、API 側でプレフィックスフィルターを提供する。

### ページング
```pseudo
カーソル = null
do:
    (キー群, 次カーソル) = キー列挙(開始: カーソル, 上限: 100)
    処理(キー群)
    カーソル = 次カーソル
while カーソル != null
```
- 大規模データで全キーを一度に読み込まないよう、カーソルベースの API を設計する。

## 注意点
1. **性能**: キーの数が多いと列挙コストが高い。必要なキーだけを問い合わせできる API を提供する。
2. **整合性**: 同時更新中にキーが抜け落ちたり二重に出たりしないよう、ロックや世代番号を持たせる。
3. **機密情報**: シークレットキーを列挙させないアクセス制御を設ける。

## 関連トピック
- `abstract/associative-array/index.md`: 連想配列
- `abstract/value-enumeration/index.md`: 値列挙
- `abstract/associative-array-deletion/index.md`: 列挙と削除の組み合わせ
