---
title: インスタンスの初期化処理
description: 生成直後のオブジェクトへ状態を設定する手順
---

## 概要
インスタンス初期化は、生成したオブジェクトのフィールドに値を与え、不変条件を満たすよう整える工程である。コンストラクター、初期化ブロック、プロパティセッターなどを組み合わせる。

## 初期化ポイント
- **コンストラクター**: 引数を受け取りながら主要フィールドを設定する。
- **初期化ブロック**: 言語によってはコンストラクター前後に共通処理を実行できる。
- **遅延初期化**: 重いリソースを必要になるまで作らない。

## 基本例
```pseudo
クラス 接続:
    プロパティ ハンドル

    コンストラクター(設定):
        ハンドル = ネットワーク.接続(設定)
```
- 必要なリソースを取得し、失敗時には例外を投げる。

## 応用パターン
### ビルダーの利用
```pseudo
接続 = 接続ビルダー()
    .宛先("example.com")
    .タイムアウト(5秒)
    .作成()
```
- 初期化項目が多い場合はビルダーで段階的に設定する。

### フック
```pseudo
クラス 基底:
    コンストラクター():
        self.afterInit()

    メソッド afterInit(): pass
```
- 派生クラスが後処理を行えるようにフックメソッドを用意する。

## 注意点
1. **順序依存**: フィールドの初期化順によって依存関係が壊れることがある。相互依存を避ける。
2. **例外安全性**: 初期化途中で例外が発生した場合、確保したリソースを解放し、半端な状態を外部へ公開しない。
3. **テスト性**: 初期化ロジックが重いとテストが難しい。依存を注入し、モック可能にする。

## 関連トピック
- `abstract/instance-creation/index.md`: 生成プロセス
- `abstract/class/index.md`: クラス構造
- `abstract/encapsulation/index.md`: 状態管理
