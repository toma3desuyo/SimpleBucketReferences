---
title: 変数の有効範囲
description: 変数が参照できる範囲と寿命を管理するルール
---

## 概要
変数スコープは、変数がどの範囲でアクセス可能かを定めるルールである。ブロックスコープ、関数スコープ、グローバルスコープなどがあり、ライフタイムとメモリ管理に影響する。

## 種類
- **ブロックスコープ**: `{}` や `if` などのブロックごとに変数を閉じ込める。
- **関数スコープ**: 関数内で宣言された変数は外部から見えない。
- **グローバルスコープ**: プログラム全体から参照可能。汚染に注意。
- **レキシカルスコープ**: スコープがネスト構造に従って決まる。

## 基本例
```pseudo
if 条件:
    変数 = 1
print(変数)  # ブロックスコープならエラー
```
- スコープ外からは参照できない。

## 応用パターン
### クロージャー
```pseudo
関数 カウンター():
    count = 0
    return 無名関数():
        count += 1
        return count
```
- 内部関数が外側のスコープを捕捉する。

### 名前空間
```pseudo
モジュール = (function():
    private 変数
    return { 公開メソッド }
)()
```
- 即時関数でスコープを作り、公開するものだけ返す。

## 注意点
1. **変数の巻き上げ**: 宣言がスコープの先頭へ移動する言語がある。初期化のタイミングに注意。
2. **グローバル汚染**: グローバル変数は名前衝突や副作用の原因となる。必要最小限に抑える。
3. **ライフタイム**: 長寿命のスコープに大きなオブジェクトを置くと GC が解放できない。適切なスコープで宣言する。

## 関連トピック
- `abstract/declaration/index.md`: 変数宣言
- `abstract/anonymous-function/index.md`: クロージャー
- `abstract/encapsulation/index.md`: 情報隠蔽
