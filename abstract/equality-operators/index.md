---
title: 等価演算子
description: 2 つの値が等しいか否かを判定する演算子
---

## 概要
等価演算子は 2 つの値の一致を調べ、真偽値を返す。`==`、`!=`、厳密等価 `===` などがあり、値比較と参照比較を使い分ける必要がある。

## 比較戦略
- **値の等価**: 数値や文字列などプリミティブ値を比較する。型変換を伴うかどうかを仕様で統一する。
- **参照の同一性**: オブジェクトのメモリアドレスや ID を比較する。内容が同じでも参照が違えば偽になる。
- **深い等価**: ネスト構造の中身を再帰的に比較する。計算コストが高いため用途を限定する。

## 基本例
```pseudo
もし ユーザーID == 入力ID なら 認証成功
もし 設定 === 既定設定 なら 再計算せず再利用
```
- 厳密比較を使うことで暗黙の型変換による意図しない一致を避ける。

## 応用パターン
### カスタム比較器
```pseudo
関数 同じラベルか(A, B):
    return 正規化(A) == 正規化(B)
```
- 大文字小文字を無視したり、空白を除去するなどドメイン固有の比較を関数化する。

### セット構造
```pseudo
集合.追加(要素)
集合.存在(要素)  # 内部で等価比較が使われる
```
- セットのキー比較ルールが等価演算に依存する。ハッシュコードと整合させる。

## 注意点
1. **浮動小数点**: 直接比較すると誤差により不一致となる。許容誤差を用いた比較を行う。
2. **NaN**: 一部言語では NaN == NaN が偽になる。`isNaN` など専用判定を使う。
3. **オブジェクトの循環参照**: 深い等価比較で循環があると無限ループになる。訪問済み集合を管理する。

## 関連トピック
- `abstract/comparison-operators/index.md`: 大小比較
- `abstract/boolean-type/index.md`: 真偽値の扱い
- `abstract/regular-expression/index.md`: 文字列比較を補助する
